<% include ../partials/head %>

<% include ../partials/nav %>

<main class="main--medium main--account">
  <section>
    <div class="row">
      <p>Username:</p>
      <p><%= user.name %></p>
    </div>

    <div class="row">
      <p>E-mail:</p>
      <p><%= user.email %></p>
    </div>

    <div class="buttons">
      <button type="button" name="button" id="change-password" class="button--small">Change password</button>

      <% if (config.allowChangeEmail) { %>
        <button type="button" name="button" id="change-email" class="button--small">Change e-mail</button>
      <% } %>

      <% if (config.allowDeleteAccount) { %>
        <button type="button" name="button" id="delete-account" class="button--small">Delete account</button>
      <% } %>
    </div>
  </section>

  <section>
    <form action="/change-password" method="post" id="change-password-form" class="hidden">
      <h4>Change password</h4>
      <fieldset>
        <div class="field field--first">
          <label for="old-password">Old password</label>
          <input id="old-password" type="password" name="old-password" required>
        </div>

        <div class="field">
          <label for="new-password">New password</label>
          <input id="new-password" type="password" name="new-password" min="8" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" required>
        </div>

        <div class="field">
          <label for="confirm-password">Confirm new password</label>
          <input id="confirm-password" type="password" name="confirm-password" required>
        </div>
      </fieldset>

      <fieldset class="fieldset--transparent submit-form">
        <input type="submit" name="submit" id="submit-change-password" class="button button--submit">
      </fieldset>
    </form>

    <% if (config.allowChangeEmail) { %>
      <form action="/change-email" method="post" id="change-email-form" class="hidden">
        <h4>Change e-mail adress</h4>
        <fieldset>
          <div class="field field--first">
            <label for="email">New e-mail</label>
            <input id="email" type="email" name="email" placeholder="joopie@example.com" required>
          </div>

          <div class="field">
            <label for="password">Password</label>
            <input id="password" type="password" name="password" required>
          </div>
        </fieldset>

        <fieldset class="fieldset--transparent submit-form">
          <input type="submit" name="submit" id="submit-change-email" class="button button--submit">
        </fieldset>
      </form>
    <% } %>

    <% if (config.allowDeleteAccount) { %>
      <form action="/delete-account" method="post" id="delete-account-form" class="hidden">
        <h4>Delete account</h4>
        <h5>Enter your password if you are sure you want to delete your account.</h5>
        
        <fieldset>
          <div class="field field--first">
            <label for="passwd">Password</label>
            <input id="passwd" type="password" name="password" required>
          </div>
        </fieldset>

        <fieldset class="fieldset--transparent submit-form">
          <input type="submit" name="submit" id="submit-delete-account" class="button button--submit">
        </fieldset>
      </form>
    <% } %>
  </section>
</main>

<script src="js/account.js"></script>

<% include ../partials/tail %>
