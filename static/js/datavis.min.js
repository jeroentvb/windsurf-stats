'use strict';function init(){request('/data').then(function(a){return parseSailUsage(a)}).then(function(a){return renderSailUsageGraph(a)}).catch(function(a){return console.error(a)})}function request(a){return new Promise(function(b,c){var e=new XMLHttpRequest;e.onreadystatechange=function(){4===e.readyState&&200===e.status?b(JSON.parse(e.responseText)):404===e.status&&c(new Error('The server responded with 404, not found'))},e.open('GET',a,!0),e.send()})}function parseSailUsage(a){var b=[];return a.forEach(function(c,e){var f=!1;return 0===e?void b.push({name:c.sailSize,count:1}):void(b.forEach(function(h){h.name===c.sailSize&&(h.count++,f=!0)}),!1==f&&b.push({name:c.sailSize,count:1}))}),b.reverse()}function renderSailUsageGraph(a){var h={width:document.getElementById('sail-usage').clientWidth,height:500},j={top:10,right:0,bottom:30,left:30},b=d3.scaleBand().domain(a.map(function(l){return l.name})).range([j.left,h.width-j.right]).padding(0.1),c=d3.scaleLinear().domain([0,d3.max(a,function(l){return l.count})]).nice().range([h.height-j.bottom,j.top]),k=d3.select('svg').attr('width',h.width).attr('height',h.height);k.append('g').attr('fill','steelblue').selectAll('rect').data(a).enter().append('rect').attr('x',function(l){return b(l.name)}).attr('y',function(l){return c(l.count)}).attr('height',function(l){return c(0)-c(l.count)}).attr('width',b.bandwidth()),k.append('g').call(function e(l){return l.attr('transform','translate(0,'+(h.height-j.bottom)+')').call(d3.axisBottom(b).tickSizeOuter(0))}),k.append('g').call(function f(l){return l.attr('transform','translate('+j.left+',0)').call(d3.axisLeft(c)).call(function(m){return m.select('.domain').remove()})})}init();
